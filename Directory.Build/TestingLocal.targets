<Project>
   <Target Name="GetPackageVersion" BeforeTargets="GetPackageMetadata" AfterTargets="MinVer" Returns="$(PackageVersion)" Condition="'$(Configuration)' == 'Local'">
    <ItemGroup>
      <PackageVersion Update="$(PackageId)" Version="0.0.1-Local" />
    </ItemGroup>
    <PropertyGroup>
      <PackageVersion>0.0.1-Local</PackageVersion>
      <Version>0.0.1-Local</Version>
      <AssemblyVersion>0.0.1</AssemblyVersion>
      <VersionSuffix>-Local</VersionSuffix>
      <InformationalVersion>0.0.1-Local</InformationalVersion>
    </PropertyGroup>
   </Target>

    <Target Name="PushNuGetPackageToLocal" AfterTargets="Pack" Condition="'$(Configuration)' == 'Local' And '$(GeneratePackageOnBuild)' == 'true'">
        <Exec Command="dotnet nuget delete $(PackageId) $(PackageVersion) -s Local --non-interactive" ContinueOnError="true" />
        <Exec Command="dotnet nuget push $(PackageTargetPath) -s Local" Condition="Exists('$(PackageTargetPath)')" />
    </Target>

   <ItemGroup>
      <_JustinWritesCodePackageReference Include="@(PackageReference)" Condition="$([System.String]::Copy('%(Identity)').StartsWith('JustinWritesCode'))" />
      <PackageReference Update="@(_JustinWritesCodePackageReference)" VersionOverride="0.0.1-Local" />
   </ItemGroup>
</Project>
